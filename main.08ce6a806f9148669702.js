(()=>{"use strict";var e,t={2756:()=>{var e=new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#3399CC"}),stroke:new ol.style.Stroke({color:"#fff",width:1})})}),t=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(51,153,204,0.33)"}),stroke:new ol.style.Stroke({color:"#fff",width:1})}),n="FETCH_GEO_INFO",r={},o=function(e){return function(e){var t=e.type,o=e.payload;if(t===n){var l=o.id;if("properties"in o){var i=o.properties;return r[l]=i}return r[l]={message:"информация отсутсвует"}}return r}({type:n,payload:e})};function l(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,i,a=[],c=!0,s=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s,u,f,y=function(e,t,n){for(var r="",o=0,l=Object.entries(e);o<l.length;o++){var i=a(l[o],2),c=i[0],s=i[1];r+="<div>\n            <p>".concat(c.toLowerCase(),":</p>\n            <span>").concat(s,"</span>\n            </div>")}return"<section>".concat(r,"\n            <div>\n            <p>площадь:</p>\n            <span>").concat(Math.round(n.sphere),"&#13217</span>\n            </div>\n</section>")},p=(s=function(e,t,n,i,a){var c=e.coordinate;if(t.id&&n.hasFeatureAtPixel(e.pixel))if(t.id in r){var s=r[t.id];i.innerHTML=y(s,0,t),a.setPosition(c)}else(function(e){try{return fetch("http://localhost:5000/api/geoinfo?id=".concat(e)).then((function(e){return e.json()})).then((function(e){return o.apply(void 0,l(e))}))}catch(e){console.log(e)}})(t.id).then((function(e){i.innerHTML=y(e,0,t),a.setPosition(c)}))},u=300,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];f&&clearTimeout(f),f=setTimeout((function(){s.apply(void 0,t)}),u)}),d=new ol.style.Style({stroke:new ol.style.Stroke({color:"#138b4f",width:2}),fill:new ol.style.Fill({color:"rgba(109,217,127,0)"})}),v={Point:new ol.style.Style({image:new ol.style.Icon({anchor:[.5,26],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"../public/svgs1.svg",scale:.7})}),Polygon:new ol.style.Style({stroke:new ol.style.Stroke({color:"#138b4f",width:3}),fill:new ol.style.Fill({color:"#6dd97f"})})},g=new ol.layer.Vector({source:new ol.source.Vector({url:"http://localhost:5000/api/geojson",format:new ol.format.GeoJSON({featureProjection:"EPSG:3857"})}),style:function(e,t){return"Point"===e.getGeometry().getType()?t<288?v[e.getGeometry().getType()]:null:v[e.getGeometry().getType()]},visible:!0,title:"map"});document.querySelector("#geoJson-input").addEventListener("input",(function(e){var t=e.target.value;e.target.nextElementSibling.disabled=!t.includes("FeatureCollection")})),document.querySelector("#geoJson-button").addEventListener("click",(function(e){(function(e){try{return fetch("http://localhost:5000/api/geojson",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:e}).then((function(e){return e.status}))}catch(e){console.log(e)}})(e.target.previousElementSibling.value).then((function(e){return 200===e?g.getSource().refresh():null}))}));var m=new ol.layer.Tile({source:new ol.source.OSM,title:"OSM",visible:!0}),h={worldTopoMap:new ol.layer.Tile({source:new ol.source.XYZ({attributions:'Tiles © <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}.png"}),title:"worldTopoMap",visible:!1}),stamenTerrain:new ol.layer.Tile({source:new ol.source.XYZ({url:"https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"}),title:"stamenTerrain",visible:!1})},w=new ol.layer.Group({layers:[m,h.stamenTerrain,h.worldTopoMap]});document.querySelector("#select-map").addEventListener("change",(function(e){var t=e.target.options,n=t[t.selectedIndex].value;w.getLayers().forEach((function(e){var t=e.get("title");e.setVisible(n===t)}))})),window.onload=function(){var n=new ol.View({center:[0,0],zoom:1}),r=new ol.Map({target:"map",view:n});r.addLayer(w),r.addLayer(g),function(e){var t,n=document.getElementById("popup"),r=document.getElementById("popup-content"),o=document.getElementById("popup-closer"),l=new ol.Overlay({element:n,autoPan:!0,autoPanAnimation:{duration:250}});e.addOverlay(l),e.on("pointermove",(function(n){var i,a={id:"",sphere:""};null!==t&&(null===(i=t)||void 0===i||i.setStyle(void 0),t=null),e.forEachFeatureAtPixel(n.pixel,(function(e){return a.id=e.id_,a.sphere=ol.sphere.getArea(e.getGeometry(),"EPSG:3857",6378137),e.id_&&"Polygon"===e.getGeometry().getType()&&(t=e,e.setStyle(d)),!0})),p(n,a,e,r,l),e.hasFeatureAtPixel(n.pixel)||(l.setPosition(void 0),o.blur())}))}(r),function(n,r){var o,l=new ol.Geolocation({trackingOptions:{enableHighAccuracy:!0},projection:r.getProjection()}),i=new ol.Feature,a=new ol.Feature;(o="track-position",document.getElementById(o)).addEventListener("click",(function(n){n.target.classList.toggle("track"),n.target.classList.contains("track")?(l.setTracking(n.target),l.on("error",(function(e){var t=document.getElementById("info");t.innerHTML=e.message,t.style.display=""})),l.on("change:accuracyGeometry",(function(){i.setGeometry(l.getAccuracyGeometry())})),l.once("change",(function(){return function(e,t,n){var r=1e3,o=n.getZoom(),l=1,i=!1;function a(e){--l,i||0!==l&&e||(i=!0,t(e))}n.animate({center:e,duration:r},a),n.animate({zoom:o-1,duration:500},{zoom:10,duration:r},a)}(l.values_.position,(function(){}),r)})),a.setStyle(e),i.setStyle(t),l.on("change:position",(function(){var e=l.getPosition();a.setGeometry(e?new ol.geom.Point(e):null)}))):(l.setTracking(!1),i.setStyle(null),a.setStyle(null),a.setGeometry(null),i.setGeometry(null))})),new ol.layer.Vector({map:n,source:new ol.source.Vector({features:[i,a]})})}(r,n)}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var l=n[e]={exports:{}};return t[e](l,l.exports,r),l.exports}r.m=t,e=[],r.O=(t,n,o,l)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,o,l]=e[u],a=!0,c=0;c<n.length;c++)(!1&l||i>=l)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(a=!1,l<i&&(i=l));if(a){e.splice(u--,1);var s=o();void 0!==s&&(t=s)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,o,l]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,l,[i,a,c]=n,s=0;if(i.some((t=>0!==e[t]))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);if(c)var u=c(r)}for(t&&t(n);s<i.length;s++)l=i[s],r.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return r.O(u)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.O(void 0,[202],(()=>r(1202)));var o=r.O(void 0,[202],(()=>r(2756)));o=r.O(o)})();