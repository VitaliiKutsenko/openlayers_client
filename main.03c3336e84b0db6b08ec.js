(()=>{"use strict";var e,t={2756:()=>{var e=new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#3399CC"}),stroke:new ol.style.Stroke({color:"#fff",width:1})})}),t=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(51,153,204,0.33)"}),stroke:new ol.style.Stroke({color:"#fff",width:1})}),r="FETCH_GEO_INFO",n={},o=function(e){return function(e){var t=e.type,o=e.payload;if(t===r){var l=o.id;if("properties"in o){var i=o.properties;return n[l]=i}return n[l]={message:"информация отсутсвует"}}return n}({type:r,payload:e})};function l(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,i,a=[],c=!0,s=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=l.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s,u,p,f=function(e,t,r){for(var n="",o=0,l=Object.entries(e);o<l.length;o++){var i=a(l[o],2),c=i[0],s=i[1];n+="<div>\n            <p>".concat(c.toLowerCase(),":</p>\n            <span>").concat(s,"</span>\n            </div>")}return"<section>".concat(n,"\n            <div>\n            <p>площадь:</p>\n            <span>").concat(Math.round(r.sphere),"&#13217</span>\n            </div>\n</section>")},y=(s=function(e,t,r,i,a){var c=e.coordinate;if(t.id&&r.hasFeatureAtPixel(e.pixel))if(t.id in n){var s=n[t.id];i.innerHTML=f(s,0,t),a.setPosition(c)}else(function(e){try{return fetch("https://openlayers-server.vercel.app/api/geoinfo?id=".concat(e),{mode:"no-cors"}).then((function(e){return e.json()})).then((function(e){return o.apply(void 0,l(e))}))}catch(e){console.log(e)}})(t.id).then((function(e){i.innerHTML=f(e,0,t),a.setPosition(c)}))},u=300,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];p&&clearTimeout(p),p=setTimeout((function(){s.apply(void 0,t)}),u)}),d=new ol.style.Style({stroke:new ol.style.Stroke({color:"#138b4f",width:2}),fill:new ol.style.Fill({color:"rgba(109,217,127,0)"})}),v={Point:new ol.style.Style({image:new ol.style.Icon({anchor:[.5,26],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"./svgs1.svg",scale:.7})}),Polygon:new ol.style.Style({stroke:new ol.style.Stroke({color:"#138b4f",width:3}),fill:new ol.style.Fill({color:"#6dd97f"})})},g=new ol.layer.Vector({source:new ol.source.Vector({url:"https://openlayers-server.vercel.app/api/geojson",format:new ol.format.GeoJSON({featureProjection:"EPSG:3857"})}),style:function(e,t){return"Point"===e.getGeometry().getType()?t<288?v[e.getGeometry().getType()]:null:v[e.getGeometry().getType()]},visible:!0,title:"map"});document.querySelector("#geoJson-input").addEventListener("input",(function(e){var t=e.target.value;e.target.nextElementSibling.disabled=!t.includes("FeatureCollection")})),document.querySelector("#geoJson-button").addEventListener("click",(function(e){(function(e){try{return fetch("https://openlayers-server.vercel.app/api/geojson",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:e,mode:"no-cors"}).then((function(e){return e.status}))}catch(e){console.log(e)}})(e.target.previousElementSibling.value).then((function(e){return 200===e?g.getSource().refresh():null}))}));var m=new ol.layer.Tile({source:new ol.source.OSM,title:"OSM",visible:!0}),h={worldTopoMap:new ol.layer.Tile({source:new ol.source.XYZ({attributions:'Tiles © <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}.png"}),title:"worldTopoMap",visible:!1}),stamenTerrain:new ol.layer.Tile({source:new ol.source.XYZ({url:"https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"}),title:"stamenTerrain",visible:!1})},w=new ol.layer.Group({layers:[m,h.stamenTerrain,h.worldTopoMap]});document.querySelector("#select-map").addEventListener("change",(function(e){var t=e.target.options,r=t[t.selectedIndex].value;w.getLayers().forEach((function(e){var t=e.get("title");e.setVisible(r===t)}))})),window.onload=function(){var r=new ol.View({center:[0,0],zoom:1}),n=new ol.Map({target:"map",view:r});n.addLayer(w),n.addLayer(g),function(e){var t,r=document.getElementById("popup"),n=document.getElementById("popup-content"),o=document.getElementById("popup-closer"),l=new ol.Overlay({element:r,autoPan:!0,autoPanAnimation:{duration:250}});e.addOverlay(l),e.on("pointermove",(function(r){var i,a={id:"",sphere:""};null!==t&&(null===(i=t)||void 0===i||i.setStyle(void 0),t=null),e.forEachFeatureAtPixel(r.pixel,(function(e){return a.id=e.id_,a.sphere=ol.sphere.getArea(e.getGeometry(),"EPSG:3857",6378137),e.id_&&"Polygon"===e.getGeometry().getType()&&(t=e,e.setStyle(d)),!0})),y(r,a,e,n,l),e.hasFeatureAtPixel(r.pixel)||(l.setPosition(void 0),o.blur())}))}(n),function(r,n){var o,l=new ol.Geolocation({trackingOptions:{enableHighAccuracy:!0},projection:n.getProjection()}),i=new ol.Feature,a=new ol.Feature;(o="track-position",document.getElementById(o)).addEventListener("click",(function(r){r.target.classList.toggle("track"),r.target.classList.contains("track")?(l.setTracking(r.target),l.on("error",(function(e){var t=document.getElementById("info");t.innerHTML=e.message,t.style.display=""})),l.on("change:accuracyGeometry",(function(){i.setGeometry(l.getAccuracyGeometry())})),l.once("change",(function(){return function(e,t,r){var n=1e3,o=r.getZoom(),l=1,i=!1;function a(e){--l,i||0!==l&&e||(i=!0,t(e))}r.animate({center:e,duration:n},a),r.animate({zoom:o-1,duration:500},{zoom:10,duration:n},a)}(l.values_.position,(function(){}),n)})),a.setStyle(e),i.setStyle(t),l.on("change:position",(function(){var e=l.getPosition();a.setGeometry(e?new ol.geom.Point(e):null)}))):(l.setTracking(!1),i.setStyle(null),a.setStyle(null),a.setGeometry(null),i.setGeometry(null))})),new ol.layer.Vector({map:r,source:new ol.source.Vector({features:[i,a]})})}(n,r)}}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var l=r[e]={exports:{}};return t[e](l,l.exports,n),l.exports}n.m=t,e=[],n.O=(t,r,o,l)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,o,l]=e[u],a=!0,c=0;c<r.length;c++)(!1&l||i>=l)&&Object.keys(n.O).every((e=>n.O[e](r[c])))?r.splice(c--,1):(a=!1,l<i&&(i=l));if(a){e.splice(u--,1);var s=o();void 0!==s&&(t=s)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[r,o,l]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,l,[i,a,c]=r,s=0;if(i.some((t=>0!==e[t]))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(c)var u=c(n)}for(t&&t(r);s<i.length;s++)l=i[s],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(u)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.O(void 0,[202],(()=>n(1202)));var o=n.O(void 0,[202],(()=>n(2756)));o=n.O(o)})();